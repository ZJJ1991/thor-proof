"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const params_1 = require("./params");
exports.calcIntrinsicGas = function (tx) {
    let totalGas = params_1.params.TxGas;
    // calculate data gas
    if (tx.data) {
        const buffer = new Buffer(exports.sanitizeHex(tx.data), "hex");
        let z = 0;
        let nz = 0;
        for (const byte of buffer) {
            if (byte) {
                nz++;
            }
            else {
                z++;
            }
        }
        totalGas += params_1.params.TxDataZeroGas * z;
        totalGas += params_1.params.TxDataNonZeroGas * nz;
    }
    if (!!tx.to) {
        totalGas += params_1.params.ClauseGas;
    }
    else {
        totalGas += params_1.params.ClauseGasContractCreation;
    }
    return totalGas;
};
exports.MaxUint32 = Math.pow(2, 32) - 1;
exports.toPrefixedHex = function (hexStr) {
    if (hexStr.indexOf("0x") === 0) {
        return hexStr;
    }
    else {
        return "0x" + hexStr;
    }
};
exports.sanitizeHex = function (hexStr) {
    if (hexStr.indexOf("0x") === 0) {
        return hexStr.substr(2);
    }
    else {
        return hexStr;
    }
};
exports.isHex = function (hex) {
    return ((typeof hex === "string") && /^(-0x|0x)?[0-9a-f]*$/i.test(hex));
};
exports.newNonce = function () {
    return Math.floor((new Date().getTime() / 0xffff) * Math.random() * 0xffff);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOztBQUdiLHFDQUFnQztBQUVuQixRQUFBLGdCQUFnQixHQUFHLFVBQVMsRUFBbUI7SUFDMUQsSUFBSSxRQUFRLEdBQUcsZUFBTSxDQUFDLEtBQUssQ0FBQztJQUU1QixxQkFBcUI7SUFDckIsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFO1FBQ1gsTUFBTSxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsbUJBQVcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1YsSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsS0FBSyxNQUFNLElBQUksSUFBSSxNQUFNLEVBQUU7WUFDekIsSUFBSSxJQUFJLEVBQUU7Z0JBQ1IsRUFBRSxFQUFFLENBQUM7YUFDTjtpQkFBTTtnQkFDTCxDQUFDLEVBQUUsQ0FBQzthQUNMO1NBQ0Y7UUFDRCxRQUFRLElBQUksZUFBTSxDQUFDLGFBQWEsR0FBRyxDQUFDLENBQUM7UUFDckMsUUFBUSxJQUFJLGVBQU0sQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7S0FDMUM7SUFFRCxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ1gsUUFBUSxJQUFJLGVBQU0sQ0FBQyxTQUFTLENBQUM7S0FDOUI7U0FBTTtRQUNMLFFBQVEsSUFBSSxlQUFNLENBQUMseUJBQXlCLENBQUM7S0FDOUM7SUFFRCxPQUFPLFFBQVEsQ0FBQztBQUNsQixDQUFDLENBQUM7QUFFVyxRQUFBLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUM7QUFFaEMsUUFBQSxhQUFhLEdBQUcsVUFBUyxNQUFjO0lBQ2xELElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDOUIsT0FBTyxNQUFNLENBQUM7S0FDZjtTQUFNO1FBQ0wsT0FBTyxJQUFJLEdBQUcsTUFBTSxDQUFDO0tBQ3RCO0FBQ0gsQ0FBQyxDQUFDO0FBRVcsUUFBQSxXQUFXLEdBQUcsVUFBUyxNQUFjO0lBQ2hELElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDOUIsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3pCO1NBQU07UUFDTCxPQUFPLE1BQU0sQ0FBQztLQUNmO0FBQ0gsQ0FBQyxDQUFDO0FBRVcsUUFBQSxLQUFLLEdBQUcsVUFBUyxHQUFXO0lBQ3ZDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sR0FBRyxLQUFLLFFBQVEsQ0FBQyxJQUFJLHVCQUF1QixDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzFFLENBQUMsQ0FBQztBQUVXLFFBQUEsUUFBUSxHQUFHO0lBQ3RCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLE1BQU0sQ0FBQyxDQUFDO0FBQzlFLENBQUMsQ0FBQyJ9